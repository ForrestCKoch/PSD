Loading python3/3.8.5
  Loading requirement: intel-mkl/2020.2.254
/apps/python3/3.8.5/lib/python3.8/site-packages/numpy-1.19.1-py3.8-linux-x86_64.egg/numpy/lib/function_base.py:2559: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[:, None]
/apps/python3/3.8.5/lib/python3.8/site-packages/numpy-1.19.1-py3.8-linux-x86_64.egg/numpy/lib/function_base.py:2560: RuntimeWarning: invalid value encountered in true_divide
  c /= stddev[None, :]
Filename: /scratch/yr31/fk5479/psd/PSD/psd/psd.py

Line #    Mem usage    Increment  Occurences   Line Contents
============================================================
     5   3568.1 MiB   3568.1 MiB           1   @profile
     6                                         def psd(X):    
     7                                             """    
     8                                             :param: X is a matrix (samples x genes)    
     9                                             """    
    10   3568.1 MiB      0.0 MiB           1       s, g = X.shape # samples x genes    
    11   9589.5 MiB   6021.5 MiB           1       corr = np.corrcoef(X,rowvar=False) # yields g x g corrcoef matrix ...    
    12   9589.7 MiB      0.2 MiB           1       np.nan_to_num(corr,copy=False)
    13  13105.4 MiB   3515.6 MiB           1       aat = np.matmul(X,corr) # s x g matrix, equivalent to aa' in Trans_PSD.m     
    14   7124.8 MiB  -5980.6 MiB           1       del corr
    15  10757.7 MiB   3632.9 MiB           1       pst = np.abs(fft(np.abs(aat)))/g # s x g matrix, equivalent to ps'     
    16   7258.0 MiB  -3499.7 MiB           1       del aat 
    17  10757.7 MiB   3499.8 MiB           1       pro_pst = pst / np.sum(pst,1)[:,np.newaxis]    
    18   7258.0 MiB  -3499.8 MiB           1       del pst
    19  10757.7 MiB   3499.8 MiB           1       Aaat = np.multiply(pro_pst,np.log2(pro_pst))    
    20   7258.0 MiB  -3499.8 MiB           1       del pro_pst
    21  10757.7 MiB   3499.8 MiB           1       aaat = -(np.mean(Aaat,0)-Aaat)    
    22   7258.0 MiB  -3499.8 MiB           1       del Aaat
    23  10757.7 MiB   3499.8 MiB           1       Yt = (aaat - aaat.min(0)[np.newaxis,:])/(aaat.max(0)-aaat.min(0))[np.newaxis,:] # min/max scaling across genes    
    24  10757.7 MiB      0.0 MiB           1       return Yt   



======================================================================================
                  Resource Usage on 2020-11-17 10:28:31:
   Job Id:             13566125.gadi-pbs
   Project:            yr31
   Exit Status:        0
   Service Units:      1.03
   NCPUs Requested:    28                     NCPUs Used: 28              
                                           CPU Time Used: 00:21:24                                   
   Memory Requested:   256.0GB               Memory Used: 21.01GB         
   Walltime requested: 04:00:00            Walltime Used: 00:01:44        
   JobFS requested:    100.0MB                JobFS used: 0B              
======================================================================================
